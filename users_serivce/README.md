# Документация к сервису пользователей

## Описание
Этот сервис разработан с использованием **TypeScript**, **Node.js**, **NestJS**, **MySQL** и **Sequelize ORM**. Он предоставляет эндпоинты для управления пользователями в базе данных, включая получение списка пользователей, создание и решение их проблем.

## Возможности
- **Получение всех пользователей**: Возвращает всех пользователей из базы данных.
- **Создание пользователя**: Добавляет нового пользователя в базу данных.
- **Решение проблем**: Устанавливает флаг `problems` для всех пользователей в значение `false` и возвращает количество решённых проблем.

## Установка

### Необходимые условия
- Node.js (версии 14 или выше)
- MySQL Database

### Шаги
1. Клонируйте репозиторий:
   ```bash
   git clone <repository-url>
   cd <repository-folder>
   ```
2. Установите зависимости:
   ```bash
   npm install
   ```
3. Настройте подключение к базе данных в файле `.env`:
   ```env
   DB_HOST=localhost
   DB_PORT=3306
   DB_USER=root
   DB_PASSWORD=yourpassword
   DB_NAME=yourdatabase
   ```
4. Запустите приложение:
   ```bash
   npm run start:dev
   ```

## API Эндпоинты

### 1. Получение всех пользователей
Возвращает всех пользователей из базы данных.

- **Эндпоинт**: `GET /users`
- **Ответ**:
  ```json
  [
    {
      "id": 1,
      "name": "John",
      "surname": "Doe",
      "age": 30,
      "gender": "male",
      "problems": true
    },
    {
      "id": 2,
      "name": "Jane",
      "surname": "Smith",
      "age": 25,
      "gender": "female",
      "problems": false
    }
  ]
  ```

### 2. Создание пользователя
Создаёт нового пользователя в базе данных.

- **Эндпоинт**: `POST /users`
- **Тело запроса**:
  ```json
  {
    "name": "Nikolay",
    "surname": "Krug",
    "age": 42,
    "gender": "male",
    "problems": true
  }
  ```
- **Ответ**:
  ```json
  {
    "id": 3,
    "name": "Nikolay",
    "surname": "Krug",
    "age": 42,
    "gender": "male",
    "problems": true
  }
  ```

### 3. Решение проблем
Устанавливает флаг `problems` для всех пользователей в значение `false` и возвращает количество пользователей, у которых были проблемы.

- **Эндпоинт**: `PUT /users/problems`
- **Ответ**:
  ```json
  "Решены проблемы у 10 пользователей"
  ```

## Структура проекта
```
.
├── src
│   ├── users
│   │   ├── users.controller.ts  # Контроллер для маршрутов, связанных с пользователями
│   │   ├── users.service.ts     # Сервис, содержащий бизнес-логику
│   │   ├── users.module.ts      # Определение модуля для пользователей
│   │   └── user.entity.ts       # Модель Sequelize для сущности User
├── utilsfiles
│   └── Insomnia_File.json       # Конфигурация Insomnia для тестирования
├── .env                         # Файл с переменными окружения
├── package.json                 # Зависимости и скрипты проекта
└── README.md                    # Документация проекта
```

## Как тестировать
1. Импортируйте файл `Insomnia_File.json` из директории `utilsfiles` в [Insomnia](https://insomnia.rest/) или другой клиент API.
2. Используйте эндпоинты для тестирования функционала:
   - `GET /users` для получения всех пользователей.
   - `POST /users` для добавления нового пользователя.
   - `PUT /users/problems` для решения проблем у всех пользователей.

## Скрипты
- **Запуск в режиме разработки**:
  ```bash
  npm run start:dev
  ```
- **Сборка для продакшена**:
  ```bash
  npm run build
  ```
- **Запуск в продакшене**:
  ```bash
  npm run start:prod
  ```

## Лицензия
Этот проект распространяется под лицензией MIT.

Nest is [MIT licensed](https://github.com/nestjs/nest/blob/master/LICENSE).
